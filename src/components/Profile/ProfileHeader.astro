---
import { getCollection, type CollectionEntry } from "astro:content";
import { theme } from "../../lib/theme";
import { Picture } from "astro:assets";

const notes = await getCollection("notes");
const publishedNotes = notes.filter((note) => note.data);
const counts = {
    all: publishedNotes.length,
    seed: publishedNotes.filter(
        (n: CollectionEntry<"notes">) => n.data.stage === "seed",
    ).length,
    sprout: publishedNotes.filter(
        (n: CollectionEntry<"notes">) => n.data.stage === "sprout",
    ).length,
    evergreen: publishedNotes.filter(
        (n: CollectionEntry<"notes">) => n.data.stage === "evergreen",
    ).length,
};

const gravatarUrl = "https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y";

const isHome = Astro.url.pathname === "/" || Astro.url.pathname === "/index.html";
const TitleTag = isHome ? "h1" : "div";
---

<div
    class="flex flex-col md:flex-row items-center justify-center gap-6 mb-12 pb-12 border-b border-slate-200 dark:border-slate-800"
    data-pagefind-ignore
>
    <Picture
        src={gravatarUrl}
        alt="Avatar"
        inferSize={true}
        loading="eager"
        class="w-32 h-32 rounded-full border-4 border-white dark:border-slate-900 shadow-sm transition-all duration-500"
    />
    <div class="flex-1 text-center md:text-left">
        <div class="flex items-center justify-center md:justify-start gap-4 mb-2">
            <TitleTag class="text-2xl font-bold text-slate-900 dark:text-slate-100">
                <a
                    href="/"
                    class="hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors"
                    >Your Name's Thoughts</a
                >
            </TitleTag>
        </div>
        <p class="text-slate-600 dark:text-slate-400 mb-4 max-w-xl">
            Exploring ideas, documenting learning, and growing knowledge one
            seed at a time. Treating every thought as a living document.
        </p>

        <div
            class="flex flex-wrap justify-center md:justify-start gap-3 text-sm"
        >
            <div class="flex items-center gap-1.5">
                <span
                    class={`w-5 h-5 rounded-full ${theme.header.seed} flex items-center justify-center text-[10px]`}
                    >ðŸŒ±</span
                >
                <span class="font-semibold text-slate-900 dark:text-slate-200"
                    >{counts.seed}</span
                >
                <span class="text-slate-500 dark:text-slate-400 font-medium"
                    >Seeds</span
                >
            </div>
            <div class="flex items-center gap-1.5">
                <span
                    class={`w-5 h-5 rounded-full ${theme.header.sprout} flex items-center justify-center text-[10px]`}
                    >ðŸŒ¿</span
                >
                <span class="font-semibold text-slate-900 dark:text-slate-200"
                    >{counts.sprout}</span
                >
                <span class="text-slate-500 dark:text-slate-400 font-medium"
                    >Sprouts</span
                >
            </div>
            <div class="flex items-center gap-1.5">
                <span
                    class={`w-5 h-5 rounded-full ${theme.header.evergreen} flex items-center justify-center text-[10px]`}
                    >ðŸŒ²</span
                >
                <span class="font-semibold text-slate-900 dark:text-slate-200"
                    >{counts.evergreen}</span
                >
                <span class="text-slate-500 dark:text-slate-400 font-medium"
                    >Evergreen</span
                >
            </div>
        </div>
    </div>
</div>
