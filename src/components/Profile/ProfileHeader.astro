---
import { getCollection, type CollectionEntry } from "astro:content";
import { theme } from "../../lib/theme";

const posts = await getCollection("posts");
const publishedPosts = posts.filter(post => !post.data.draft);
const counts = {
    all: publishedPosts.length,
    seed: publishedPosts.filter(
        (p: CollectionEntry<"posts">) => p.data.status === "seed",
    ).length,
    sprout: publishedPosts.filter(
        (p: CollectionEntry<"posts">) => p.data.status === "sprout",
    ).length,
    tree: publishedPosts.filter(
        (p: CollectionEntry<"posts">) => p.data.status === "tree",
    ).length,
};

const gravatarUrl =
    "https://www.gravatar.com/avatar/81a9730219e8014268c171f772fa1741?s=128&d=identicon";
---

<div
    class="flex flex-col md:flex-row items-center justify-center gap-6 mb-12 pb-12 border-b border-slate-200 dark:border-slate-800"
>
    <img
        src={gravatarUrl}
        alt="Avatar"
        class="w-24 h-24 rounded-full border-4 border-white dark:border-slate-900 shadow-sm transition-all duration-500"
    />
    <div class="flex-1 text-center md:text-left">
        <h1 class="text-2xl font-bold text-slate-900 dark:text-slate-100 mb-2">
            <a
                href="/"
                class="hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors"
                >Malcolm's Thoughts</a
            >
        </h1>
        <p class="text-slate-600 dark:text-slate-400 mb-4 max-w-xl">
            Exploring ideas, documenting learning, and growing knowledge one
            seed at a time. Treating every thought as a living document.
        </p>

        <div
            class="flex flex-wrap justify-center md:justify-start gap-3 text-sm"
        >
            <div class="flex items-center gap-1.5">
                <span
                    class={`w-5 h-5 rounded-full ${theme.header.seed} flex items-center justify-center text-[10px]`}
                    >ðŸŒ±</span
                >
                <span class="font-semibold text-slate-900 dark:text-slate-200"
                    >{counts.seed}</span
                >
                <span class="text-slate-500 dark:text-slate-400 font-medium"
                    >Seeds</span
                >
            </div>
            <div class="flex items-center gap-1.5">
                <span
                    class={`w-5 h-5 rounded-full ${theme.header.sprout} flex items-center justify-center text-[10px]`}
                    >ðŸŒ¿</span
                >
                <span class="font-semibold text-slate-900 dark:text-slate-200"
                    >{counts.sprout}</span
                >
                <span class="text-slate-500 dark:text-slate-400 font-medium"
                    >Sprouts</span
                >
            </div>
            <div class="flex items-center gap-1.5">
                <span
                    class={`w-5 h-5 rounded-full ${theme.header.tree} flex items-center justify-center text-[10px]`}
                    >ðŸŒ³</span
                >
                <span class="font-semibold text-slate-900 dark:text-slate-200"
                    >{counts.tree}</span
                >
                <span class="text-slate-500 dark:text-slate-400 font-medium"
                    >Trees</span
                >
            </div>
        </div>
    </div>
</div>
